<!doctype html>
<html lang="en" class="fonts-loading">

  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>日语学习应用</title>
    <!-- Google Fonts - Japanese and Chinese fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;600;700&family=Noto+Serif+JP:wght@400;500;600&display=swap" rel="stylesheet" />
    <!-- 字体加载状态处理 - 避免FOUT闪烁 -->
    <style>
      /* 字体加载中时隐藏文本，显示加载动画 */
      .fonts-loading body {
        opacity: 0;
      }
      /* 字体加载完成后平滑显示 */
      .fonts-loaded body {
        opacity: 1;
        transition: opacity 0.2s ease-in-out;
      }
      /* 加载超时后强制显示（使用备用字体） */
      .fonts-timeout body {
        opacity: 1;
      }
    </style>
    <script>
      // 使用 Font Loading API 检测字体加载状态
      (function() {
        // 设置超时时间（3秒）
        var timeout = setTimeout(function() {
          document.documentElement.classList.remove('fonts-loading');
          document.documentElement.classList.add('fonts-timeout');
        }, 3000);

        // 检测字体是否加载完成
        if ('fonts' in document) {
          Promise.all([
            document.fonts.load('400 1em "Noto Sans SC"'),
            document.fonts.load('400 1em "Noto Sans JP"')
          ]).then(function() {
            clearTimeout(timeout);
            document.documentElement.classList.remove('fonts-loading');
            document.documentElement.classList.add('fonts-loaded');
          }).catch(function() {
            clearTimeout(timeout);
            document.documentElement.classList.remove('fonts-loading');
            document.documentElement.classList.add('fonts-timeout');
          });
        } else {
          // 不支持 Font Loading API 的浏览器，直接显示
          clearTimeout(timeout);
          document.documentElement.classList.remove('fonts-loading');
          document.documentElement.classList.add('fonts-loaded');
        }
      })();
    </script>
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script
      defer
      src="%VITE_ANALYTICS_ENDPOINT%/umami"
      data-website-id="%VITE_ANALYTICS_WEBSITE_ID%"></script>
  </body>

</html>
